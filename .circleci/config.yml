version: 2.0
jobs:
  build:
    docker:
      - image: appirio/dx-salesforce:latest
    steps:
      - run:
          name: validate
          command: |
                  adx
                  adx deploy:package --deploy.testLevel NoTestRun --target QA
      - run:
          name: deploy
          command: |
                  adx
                  'adx sort:check'
                  #'adx deploy:package --deploy.testLevel RunLocalTests --deploy.checkOnly false --target QA'

workflows:
  version: 2
  build-and-deploy:
    jobs:
      - build:
          filters:
             branches:
              only:
                - qa
                - dev
                - full
                - master
     # - deploy:
      #    context: cmc-aws
       #   requires:
        #    - build
         # filters:
          #  branches:
           #   only:
            #    - qa
             #   - dev
              #  - full
               # - master

